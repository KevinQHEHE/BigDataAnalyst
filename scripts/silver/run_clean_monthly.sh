#!/usr/bin/env bash
set -euo pipefail

windows=(
  "2024-01-01T00:00:00 2024-01-31T23:00:00"
  "2024-02-01T00:00:00 2024-02-29T23:00:00"
  "2024-03-01T00:00:00 2024-03-31T23:00:00"
  "2024-04-01T00:00:00 2024-04-30T23:00:00"
  "2024-05-01T00:00:00 2024-05-31T23:00:00"
  "2024-06-01T00:00:00 2024-06-30T23:00:00"
  "2024-07-01T00:00:00 2024-07-31T23:00:00"
  "2024-08-01T00:00:00 2024-08-31T23:00:00"
  "2024-09-01T00:00:00 2024-09-30T23:00:00"
  "2024-10-01T00:00:00 2024-10-31T23:00:00"
  "2024-11-01T00:00:00 2024-11-30T23:00:00"
  "2024-12-01T00:00:00 2024-12-31T23:00:00"
  "2025-01-01T00:00:00 2025-01-31T23:00:00"
  "2025-02-01T00:00:00 2025-02-28T23:00:00"
  "2025-03-01T00:00:00 2025-03-31T23:00:00"
  "2025-04-01T00:00:00 2025-04-30T23:00:00"
  "2025-05-01T00:00:00 2025-05-31T23:00:00"
  "2025-06-01T00:00:00 2025-06-30T23:00:00"
  "2025-07-01T00:00:00 2025-07-31T23:00:00"
  "2025-08-01T00:00:00 2025-08-31T23:00:00"
)

for window in "${windows[@]}"; do
  read start end <<<"$window"
  echo "=> Running clean job for $start -> $end"
  bash scripts/submit_yarn.sh silver/clean_hourly.py \
    --start "$start" \
    --end   "$end"
  echo "=> Finished: $start -> $end"
  echo "-------------------------------------------"
done
